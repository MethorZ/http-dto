includes:
    - phpstan-baseline.neon

parameters:
    level: 9
    parallel:
        maximumNumberOfProcesses: 4
        processTimeout: 300.0
    paths:
        - src
        - tests

    # PHPStan 2.x: Most strict checks are now default at level 9
    # Removed deprecated options: checkMissingIterableValueType, checkGenericClassInNonGenericObjectType
    checkBenevolentUnionTypes: true
    reportMaybesInMethodSignatures: true
    reportStaticMethodSignatures: true

    # Symfony Validator compatibility
    universalObjectCratesClasses:
        - Symfony\Component\Validator\ConstraintViolation

    # Allow mixed in specific cases (HTTP request data)
    exceptions:
        check:
            missingCheckedExceptionInThrows: true
            tooWideThrowType: true

    # Ignore vendor issues
    excludePaths:
        - vendor
        - tests/Fixtures

    # Ignore PHPUnit assertion exceptions in tests (expected behavior)
    ignoreErrors:
        - message: '#Method .+Test::.+ throws checked exception PHPUnit\\Framework\\.+ but it''s missing from the PHPDoc @throws tag#'
          path: tests/*
        # Laminas ServiceManager interface uses untyped array, we implement correctly
        - message: '#has parameter \$_options with no value type specified in iterable type array#'
          path: src/Integration/Mezzio/DtoHandlerAbstractFactory.php
